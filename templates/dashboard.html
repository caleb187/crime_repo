{% extends 'base.html' %}
{% load static %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/dashboard.css' %}">
{% endblock %}

{% block content %}
<div class="dashboard-header">
    <div class="user-welcome">
        <h1>Welcome, {{ user.username }}</h1>
        <p class="date-today">{{ today|date:"l, F j, Y" }}</p>
        <span class="user-role">{{ user.is_staff|yesno:"Administrator,Civilian" }}</span>
        <div class="quick-stats">
            {% if user.is_staff %}
            <div class="stat-pill"><i class="fas fa-file-alt"></i> {{ total_crimes }} Total Cases</div>
            <div class="stat-pill warning"><i class="fas fa-clock"></i> {{ pending_count }} Pending</div>
            <div class="stat-pill success"><i class="fas fa-check-circle"></i> {{ resolved_count }} Resolved</div>
            {% else %}
            <div class="stat-pill"><i class="fas fa-file-alt"></i> {{ user_crimes_count }} Your Reports</div>
            {% endif %}
        </div>
    </div>
</div>

<div class="dashboard-container animate-on-scroll">    {% if user.is_staff %}
    <!-- Admin Quick Dashboard -->
    <div class="dashboard-grid">
        <div class="stats-section">
            <div class="stat-card primary animate-on-scroll">
                <div class="stat-icon"><i class="fas fa-chart-line"></i></div>
                <div class="stat-content">
                    <h3>Total Reports</h3>
                    <p class="stat-number">{{ total_crimes }}</p>
                    <div class="stat-trend">
                        <i class="fas fa-arrow-up"></i>
                        <span>12% from last month</span>
                    </div>
                </div>
            </div>
            <div class="stat-card warning animate-on-scroll">
                <div class="stat-icon"><i class="fas fa-clock"></i></div>
                <div class="stat-content">
                    <h3>Pending Cases</h3>
                    <p class="stat-number">{{ pending_count }}</p>
                    <div class="stat-progress">
                        <div class="progress-bar" style="width: {{ pending_count|default:0|percentage:total_crimes }}%"></div>
                    </div>
                </div>
            </div>
            <div class="stat-card success animate-on-scroll">
                <div class="stat-icon"><i class="fas fa-check-circle"></i></div>
                <div class="stat-content">
                    <h3>Resolved Cases</h3>
                    <p class="stat-number">{{ resolved_count }}</p>
                    <div class="stat-trend positive">
                        <i class="fas fa-arrow-up"></i>
                        <span>8% resolution rate</span>
                    </div>
                </div>
            </div>
            <div class="stat-card info animate-on-scroll">
                <div class="stat-icon"><i class="fas fa-user-shield"></i></div>
                <div class="stat-content">
                    <h3>Active Officers</h3>
                    <p class="stat-number">{{ officer_count|default:"5" }}</p>
                    <span class="stat-label">On duty</span>
                </div>
            </div>
        </div>        <div class="admin-actions animate-on-scroll">
            <h2><i class="fas fa-bolt"></i> Quick Actions</h2>
            <div class="action-buttons">
                <a href="{% url 'admin:crimes_crime_changelist' %}" class="action-button hover-lift">
                    <span class="icon"><i class="fas fa-tasks"></i></span>
                    <div class="action-content">
                        <span class="action-title">Manage Cases</span>
                        <span class="action-subtitle">Review and update case status</span>
                    </div>
                </a>
                <a href="{% url 'admin:crime_analytics' %}" class="action-button admin hover-lift">
                    <span class="icon"><i class="fas fa-chart-bar"></i></span>
                    <div class="action-content">
                        <span class="action-title">Analytics Dashboard</span>
                        <span class="action-subtitle">View insights and trends</span>
                    </div>
                </a>
                <a href="{% url 'crimes:case_map' %}" class="action-button hover-lift">
                    <span class="icon"><i class="fas fa-map-marked-alt"></i></span>
                    <div class="action-content">
                        <span class="action-title">Crime Map</span>
                        <span class="action-subtitle">Geographical crime distribution</span>
                    </div>
                </a>
                <a href="{% url 'crimes:reports_export' %}" class="action-button">
                    <span class="icon">üì•</span>
                    <span>Export Reports</span>
                </a>
                <a href="{% url 'crimes:statistics' %}" class="action-button">
                    <span class="icon">üìä</span>
                    <span>Crime Statistics</span>
                </a>
            </div>
        </div>

        <div class="recent-alerts">
            <h2>Recent High Priority Cases</h2>
            <div class="alerts-list">
                {% for crime in high_priority_crimes %}
                <div class="alert-item">
                    <h3>{{ crime.title }}</h3>
                    <div class="alert-meta">
                        <span class="priority">‚ö†Ô∏è High Priority</span>
                        <span class="date">{{ crime.created_at|date:"M d, Y" }}</span>
                    </div>
                    <a href="{% url 'crimes:crime_detail' pk=crime.pk %}" class="view-button">View Case</a>
                </div>
                {% endfor %}
            </div>
        </div>
    </div>
    {% else %}
    <!-- Civilian Dashboard -->
    <div class="dashboard-grid">
        <div class="stats-section">
            <div class="stat-card primary">
                <div class="stat-icon">üìù</div>
                <div class="stat-content">
                    <h3>My Reports</h3>
                    <p class="stat-number">{{ user_crimes_count }}</p>
                </div>
            </div>
            <div class="stat-card info">
                <div class="stat-icon">‚è≥</div>
                <div class="stat-content">
                    <h3>In Progress</h3>
                    <p class="stat-number">{{ user_active_cases }}</p>
                </div>
            </div>
        </div>

        <div class="my-reports">
            <h2>My Recent Reports</h2>
            <div class="reports-list">
                {% for crime in user_recent_crimes %}
                <div class="report-item">
                    <h3>{{ crime.title }}</h3>
                    <div class="report-meta">
                        <span class="status {{ crime.status|lower }}">{{ crime.status }}</span>
                        <span class="date">{{ crime.created_at|date:"M d, Y" }}</span>
                    </div>
                    <a href="{% url 'crimes:crime_detail' pk=crime.pk %}" class="view-button">View Details</a>
                </div>
                {% endfor %}
            </div>
        </div>

        <div class="civilian-actions">
            <h2>Quick Actions</h2>
            <div class="action-buttons">
                <a href="{% url 'crimes:crime_report' %}" class="action-button primary">
                    <span class="icon">üìù</span>
                    <span>Report New Crime</span>
                </a>
                <a href="{% url 'crimes:crime_list' %}" class="action-button">
                    <span class="icon">üìã</span>
                    <span>View My Reports</span>
                </a>
                <a href="{% url 'accounts:profile' %}" class="action-button">
                    <span class="icon">üë§</span>
                    <span>My Profile</span>
                </a>
                <a href="{% url 'crimes:safety_tips' %}" class="action-button">
                    <span class="icon">üõ°Ô∏è</span>
                    <span>Safety Tips</span>
                </a>
                <a href="{% url 'crimes:emergency_contacts' %}" class="action-button">
                    <span class="icon">‚òéÔ∏è</span>
                    <span>Emergency Contacts</span>
                </a>
            </div>
        </div>
    </div>
    {% endif %}
</div>
{% endblock %}
